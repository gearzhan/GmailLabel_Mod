# Gmail Label Manager - 测试指南

## 功能测试清单

### 1. 扩展安装和基本功能
- [ ] 扩展成功加载到Chrome
- [ ] 在Gmail页面中扩展正常运行
- [ ] 控制台显示"Gmail Label Manager installed"
- [ ] 能够读取Gmail标签

### 2. 回复按钮检测
- [ ] 点击回复按钮时触发检测
- [ ] 控制台显示"Reply button clicked"
- [ ] 成功保存原邮件标签信息
- [ ] 延迟处理撰写窗口

### 3. 标签检测功能
- [ ] 从当前邮件视图检测标签
- [ ] 从邮件线程检测标签
- [ ] 从选中邮件检测标签
- [ ] 从邮件头部检测标签
- [ ] 从URL参数检测标签
- [ ] 从侧边栏选中标签检测
- [ ] 正确过滤系统标签

### 4. 自动标签应用
- [ ] 自动模式：无确认直接应用标签
- [ ] 确认模式：显示确认对话框
- [ ] 手动模式：不自动应用标签
- [ ] 在撰写窗口显示标签提示
- [ ] 发送时应用标签

### 5. 确认对话框
- [ ] 对话框正确显示
- [ ] 标签列表正确显示
- [ ] 取消按钮功能正常
- [ ] 确认按钮功能正常
- [ ] ESC键关闭对话框
- [ ] 点击背景关闭对话框

### 6. 用户配置
- [ ] 配置页面正常加载
- [ ] 标签应用模式选择正常
- [ ] 配置保存功能正常
- [ ] 配置更新后立即生效

## 测试步骤

### 步骤1：基础安装测试
1. 打开Chrome浏览器
2. 进入扩展管理页面 (chrome://extensions/)
3. 确认Gmail Label Manager扩展已启用
4. 打开Gmail (https://mail.google.com)
5. 打开开发者工具控制台
6. 确认看到"Gmail Label Manager installed"消息

### 步骤2：配置测试
1. 右键点击扩展图标，选择"选项"
2. 在配置页面测试不同的标签应用模式
3. 保存配置并确认更改生效

### 步骤3：回复功能测试
1. 在Gmail中打开一封带有用户标签的邮件
2. 点击回复按钮
3. 根据配置模式验证行为：
   - 自动模式：标签自动应用，显示提示
   - 确认模式：显示确认对话框
   - 手动模式：无自动操作

### 步骤4：标签检测测试
1. 测试不同位置的标签检测
2. 验证系统标签被正确过滤
3. 确认用户标签被正确识别

## 已知限制

1. **Gmail API限制**：由于Chrome扩展的安全限制，无法直接通过Gmail API应用标签，主要提供视觉提示和用户体验改进。

2. **标签检测准确性**：Gmail的DOM结构可能因版本更新而变化，标签检测可能需要适配。

3. **撰写窗口检测**：Gmail的撰写窗口加载是异步的，使用了延迟处理来确保检测准确性。

## 故障排除

### 问题：扩展未加载
- 检查manifest.json语法
- 确认所有文件路径正确
- 查看扩展管理页面的错误信息

### 问题：标签检测失败
- 检查Gmail页面是否完全加载
- 确认邮件确实包含用户标签
- 查看控制台错误信息

### 问题：回复检测失败
- 确认点击的是回复按钮而非其他按钮
- 检查撰写窗口是否正确打开
- 查看控制台日志

### 问题：配置不生效
- 确认配置已保存
- 刷新Gmail页面
- 重新加载扩展

## 测试结果记录

测试日期：_______
测试人员：_______

| 功能 | 状态 | 备注 |
|------|------|------|
| 扩展加载 | ⭕ | |
| 标签读取 | ⭕ | |
| 回复检测 | ⭕ | |
| 标签检测 | ⭕ | |
| 自动应用 | ⭕ | |
| 确认对话框 | ⭕ | |
| 用户配置 | ⭕ | |

⭕ = 通过，❌ = 失败，⚠️ = 部分通过